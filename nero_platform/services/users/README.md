# Users Service

> –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

## üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
- ‚úÖ –°–≤—è–∑–∏ —Ä–æ–¥–∏—Ç–µ–ª—å-—Ä–µ–±–µ–Ω–æ–∫
- ‚úÖ –°–≤—è–∑–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç-—Ä–µ–±–µ–Ω–æ–∫
- ‚úÖ Cursor-based –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- ‚úÖ RBAC (–ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞)
- ‚úÖ Event publishing

## üîê API Endpoints

### Users

#### GET /users/v1
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (admin/supervisor only)

**Query params:**
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (max 100)
- `cursor` - –∫—É—Ä—Å–æ—Ä –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `role` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ä–æ–ª–∏
- `status` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É

**Response:**
```json
{
  "data": [...],
  "meta": {
    "total": 20,
    "hasMore": true,
    "nextCursor": "uuid"
  }
}
```

#### GET /users/v1/:id
–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID

#### PATCH /users/v1/:id
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### DELETE /users/v1/:id
–î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (admin only)

#### GET /users/v1/:id/children
–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π)

### Specialists

#### GET /users/v1/specialists
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

#### GET /users/v1/specialists/:id
–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞

#### PATCH /users/v1/specialists/:id
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞

#### GET /users/v1/specialists/:id/children
–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–µ–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞

## üöÄ –ó–∞–ø—É—Å–∫

```bash
# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker-compose exec app pnpm --filter @neiro/users-service dev
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:4002

## üìä –°–æ–±—ã—Ç–∏—è

- `users.user.updated` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω
- `users.user.suspended` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
- `users.specialist.updated` - –ø—Ä–æ—Ñ–∏–ª—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω

## üîí –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

| Endpoint | parent | specialist | supervisor | admin |
|----------|--------|------------|------------|-------|
| GET /users | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ |
| GET /users/:id | Own only | Own only | ‚úÖ | ‚úÖ |
| PATCH /users/:id | Own only | Own only | ‚ùå | ‚úÖ |
| DELETE /users/:id | ‚ùå | ‚ùå | ‚ùå | ‚úÖ |
| GET /users/:id/children | Own only | ‚ùå | ‚úÖ | ‚úÖ |
| GET /specialists | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| PATCH /specialists/:id | ‚ùå | Own only | ‚ùå | ‚úÖ |

## ‚úÖ Constitution Check

- [x] Stack Compliance (Node.js + TypeScript + PostgreSQL)
- [x] Events (3 —Å–æ–±—ã—Ç–∏—è)
- [x] API Contract —Å–ª–µ–¥—É–µ—Ç OpenAPI 3.1
- [x] Error handling (RFC 7807)
- [x] RBAC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] Cursor-based –ø–∞–≥–∏–Ω–∞—Ü–∏—è

